<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- START: inst/pkgdown/templates/head.html --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="last-modified" content="2021-12-28 00:14:29 +0000"><title>Introduction to the New Lesson Template: Maintaining a Healthy Infrastructure</title><link rel="apple-touch-icon-precomposed" sizes="57x57" href="favicons/cp/apple-touch-icon-57x57.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="favicons/cp/apple-touch-icon-114x114.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="favicons/cp/apple-touch-icon-72x72.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="favicons/cp/apple-touch-icon-144x144.png"><link rel="apple-touch-icon-precomposed" sizes="60x60" href="favicons/cp/apple-touch-icon-60x60.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="favicons/cp/apple-touch-icon-120x120.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="favicons/cp/apple-touch-icon-76x76.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="favicons/cp/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="favicons/cp/favicon-196x196.png" sizes="196x196"><link rel="icon" type="image/png" href="favicons/cp/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="favicons/cp/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="favicons/cp/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="favicons/cp/favicon-128.png" sizes="128x128"><meta name="application-name" content="The Carpentries - Introduction to the New Lesson Template"><meta name="msapplication-TileColor" content="#FFFFFF"><meta name="msapplication-TileImage" content="favicons/cp/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="favicons/cp/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="favicons/cp/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="favicons/cp/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="favicons/cp/mstile-310x310.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><!--carpentries--><link href="css/syntax.css" rel="stylesheet"><link href="css/lesson.css" rel="stylesheet"><script src="js/lesson.js"></script><meta property="og:title" content="Maintaining a Healthy Infrastructure"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- END:   inst/pkgdown/templates/head.html--></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-title-body">
      <header><!-- START: inst/pkgdown/templates/navbar.html --><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">Home</a>
        <a class="external-link navbar-link" href="https://carpentries.github.io/sandpaper-docs/" aria-label="Lesson Infrastructure is in the testing phase. Read on for more information." title="Lesson Infrastructure is in the testing phase.">üöß</a>
        <!-- TODO: the logo is not centered in the nav bar and looks ugly... also there needs to be a better way of choosing the logo... probably on the R side.-->
        <a href="https://carpentries.org" class="external-link pull-left">
          <img class="navbar-logo" src="img/cp-icon-blue.svg" alt="The Carpentries logo"></a>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="CODE_OF_CONDUCT.html">Code of Conduct</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Episodes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="introduction.html">Introduction to the New Template</a>
    </li>
    <li>
      <a href="episodes.html">Episode Structure</a>
    </li>
    <li>
      <a href="editing.html">Editing a {sandpaper} lesson</a>
    </li>
    <li>
      <a href="example.html">EXAMPLE: Using RMarkdown</a>
    </li>
    <li>
      <a href="deployment.html">Lesson Deployment</a>
    </li>
    <li>
      <a href="update.html">Maintaining a Healthy Infrastructure</a>
    </li>
    <li>
      <a href="pull-request.html">Auditing Pull Requests</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    For Learners
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="setup.html">Setup</a>
    </li>
    <li>
      <a href="github-pat.html">Setting Up a Personal Access Token via R</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    For Instructors
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="notes.html">Instructor Notes</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learner Profiles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="maintainer.html">Maintainer Profiles</a>
    </li>
    <li>
      <a href="instructor.html">Instructor Profiles</a>
    </li>
  </ul></li>
<li>
  <a href="LICENSE.html">License</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

      <!--START: inst/pkgdown/templates/header.html-->


    <div class="panel panel-default life-cycle">
      <div id="life-cycle" class="panel-body pre-alpha">
         This lesson is still being designed and assembled (Pre-Alpha version) 
        
        
      </div>
    </div>


<!--END  : inst/pkgdown/templates/header.html-->

      </header><!-- START: inst/pkgdown/templates/content-title-body.html --><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>Maintaining a Healthy Infrastructure</h1>
    </div>

<div class="section level2 objectives">
<h2>Overview</h2>
<div class="row">
<div class="col-md-3">
<p><strong>Teaching: </strong> 10<br><strong>Exercises: </strong> 2</p>
</div>
<div class="col-md-9">
<p><strong>Questions</strong></p>
<ul><li>What are the four components of the lesson infrastructure?</li>
<li>What lesson components are auto-updated on GitHub?</li>
</ul></div>
</div>
<div class="row">
<div class="col-md-3">

</div>
<div class="col-md-9">
<p><strong>Objectives</strong></p>
<ul><li>Identify components of the template needed for lesson structure, validation, styling, and deployment</li>
<li>Understand how to update R packages</li>
<li>Understand how to update GitHub workflows</li>
</ul></div>
</div>
</div>
<aside class="callout"><div class="section level4">
<h4 id="under-development"><span class="emoji" data-emoji="construction">üöß</span> Under Development<a class="anchor" aria-label="anchor" href="#under-development"></a></h4>
<p>This episode is still actively being developed</p>
</div>
</aside><div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<p>The Carpentries Lesson Infrastructure is designed to be cu</p>
</div>
<div class="section level2">
<h2 id="maintainer-tools">Maintainer Tools<a class="anchor" aria-label="anchor" href="#maintainer-tools"></a></h2>
<p>This is {sandpaper}! It takes your source files and generates the outputs!</p>
<p>Update in R with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"sandpaper"</span>, repos <span class="op">=</span> <span class="st">"https://carpentries.r-universe.dev"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="validator">Validator<a class="anchor" aria-label="anchor" href="#validator"></a></h2>
<p>This is {pegboard}! It runs behind the scenes in {sandpaper} to parse the source documents and validate things like headings, images, and cross-links. It also can extract elements like code and individual sections.</p>
<p>Update in R with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pegboard"</span>, repos <span class="op">=</span> <span class="st">"https://carpentries.r-universe.dev"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="styling">Styling<a class="anchor" aria-label="anchor" href="#styling"></a></h2>
<p>This is {varnish}! This package contains all the HTML, JavaScript, and CSS to make your generated HTML look like a Carpentries Lesson!</p>
<p>Update in R with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sandpaper</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sandpaper/man/update_varnish.html" class="external-link">update_varnish</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="deployment">Deployment<a class="anchor" aria-label="anchor" href="#deployment"></a></h2>
<div class="section level3">
<h3 id="updating-your-deployment-workflows">Updating Your Deployment Workflows<a class="anchor" aria-label="anchor" href="#updating-your-deployment-workflows"></a></h3>
<p>The workflows are the the only place in our lesson that needs to be kept up-to-date with upstream changes from [{sandpaper}]. While we try as much as possible to keep the functionality of [{sandpaper}] inside the package itself, there are times when we need to update the GitHub workflows for security or performance reasons. You can update your workflows in one of two ways: via GitHub or via [{sandpaper}].</p>
<aside class="callout"><div class="section level4">
<h4 id="under-development-1"><span class="emoji" data-emoji="construction">üöß</span> Under Development<a class="anchor" aria-label="anchor" href="#under-development-1"></a></h4>
<p>Workflow updates are still underdevelopment, but <strong>are available for use</strong>. We are exploring different methods for making these unobtrusive as possible such as specifying scheduled updates via <code>config.yaml</code> and even creating a bot that will remove the need for this workflow.</p>
</div>
</aside></div>
<div class="section level3">
<h3 id="on-schedule-default">On Schedule (default)<a class="anchor" aria-label="anchor" href="#on-schedule-default"></a></h3>
<p>The workflow update workflow is scheduled to run every Tuesday at 00:00 UTC. If there are any changes in the upstream workflows, then a Pull Request will be created with the new changes. If there are <em>no changes</em> to the workflows, then the process will silently exit and you will not be notified.</p>
</div>
<div class="section level3">
<h3 id="via-github">Via GitHub<a class="anchor" aria-label="anchor" href="#via-github"></a></h3>
<p>To update your workflows in GitHub, go to <code>https://github.com/(ORGANISATION)/(REPOSITORY)/actions/workflows/update-workflows.yaml</code></p>
<p>Once there, you will see a button that says ‚ÄúRun Workflow‚Äù in a blue field to the right of your screen. Click on that Button and it will give you two options:</p>
<ol style="list-style-type: decimal"><li>"Who this build (enter github username to tag yourself)?</li>
<li>‚ÄúWorkflow files/file extensions to clean (no wildcards, enter‚Äù" for none)</li>
</ol><p>You can leave these as-is or replace them with your own values. You can now hit the green ‚ÄúRun Workflow‚Äù button at the bottom.</p>
<p><img src="fig/update-workflow-manual.png" alt='Screen shot of GitHub interface zoomed into a button that says "Run workflow" with two options to specify your name (@zkamvar) and files to clean (.yaml). A green Run Workflow button is at the bottom of the dialogue.'></p>
<p>After ~10 seconds, your workflow will run and a pull request will be created from a GitHub bot (at the moment, this is <span class="citation">@znk-machine</span>) if your workflows are in need of updating.</p>
<p>Check the changes and merge if they look okay to you. If they do not, contact <span class="citation">@zkamvar</span>.</p>
</div>
<div class="section level3">
<h3 id="via-r">Via R<a class="anchor" aria-label="anchor" href="#via-r"></a></h3>
<p>If you want to update your workflows via R, you can use the <code><a href="https://rdrr.io/pkg/sandpaper/man/update_github_workflows.html" class="external-link">update_github_workflows()</a></code> function, which will report which files were updated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sandpaper</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sandpaper/man/update_github_workflows.html" class="external-link">update_github_workflows</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre class="output"><code>‚Ñπ Workflows/files updated:
- .github/workflows/pr-comment.yaml (modified)
- .github/workflows/pr-post-remove-branch.yaml (modified)
- .github/workflows/README.md (modified)
- .github/workflows/sandpaper-version.txt (modified)
- .github/workflows/update-workflows.yaml (new)</code></pre>
<p>After that, you can add and commit your changes and then push them to GitHub.</p>
<aside class="callout"><div class="section level4">
<h4 id="do-not-combine-workflow-changes-with-other-changes">Do not combine workflow changes with other changes<a class="anchor" aria-label="anchor" href="#do-not-combine-workflow-changes-with-other-changes"></a></h4>
<p>If you bundle a workflow changes in a pull request, you will not get the benefit of being able to inspect the output of the generated markdown files. Moreover, while we try to make these workflow files as simple as possible, they are still complex and would distract from any content that would be proposed for the lesson.</p>
</div>
</aside></div>
</div>
<div class="section level2 keypoints">
<h2>Keypoints</h2>
<ul><li>Lesson structure, validation, and styling components are all updated automatically on GitHub.</li>
<li>Lesson structure, validation, and styling components all live in your local R library.</li>
<li>Locally, R packages can be updated with <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code></li>
<li>Package styling can be updated any time with <code><a href="https://rdrr.io/pkg/sandpaper/man/update_varnish.html" class="external-link">sandpaper::update_varnish()</a></code></li>
<li>GitHub workflows live inside the lesson under <code>.github/workflows/</code></li>
<li>GitHub workflows can be updated with <code><a href="https://rdrr.io/pkg/sandpaper/man/update_github_workflows.html" class="external-link">sandpaper::update_github_workflows()</a></code></li>
</ul></div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>


<!-- END:   inst/pkgdown/templates/content-title-body.html-->


      <footer><!-- START: inst/pkgdown/templates/footer.html --><div class="container">
  <div class="row">
    <div class="col-xs-1">
      <h3 class="text-left">
        <a href="deployment.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      </h3>
    </div>
    <div class="col-xs-10">
      <h3 class="maintitle"><a href="index.html">Introduction to the New Lesson Template</a></h3>
    </div>
    <div class="col-xs-1">
      <h3 class="text-right">
        <a href="pull-request.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      </h3>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
      Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> 2018‚Äì2021
      by <a href="https://carpentries.org" class="external-link">The Carpentries</a>
      <br>
      Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> 2016‚Äì2018
      by <a href="https://softwarecarpentry.org" class="external-link">Software Carpentry Foundation</a>
    </div>
    <div class="col-md-6 help-links pull-right" align="right">
      <a href="https://github.com/carpentries/sandpaper-docs//edit/main/episodes/update.md" data-checker-ignore class="external-link">Edit on GitHub</a>
      /
      <a href="https://github.com/carpentries/sandpaper-docs//blob/main/CONTRIBUTING.md" data-checker-ignore class="external-link">Contributing</a>
      /
      <a href="https://github.com/carpentries/sandpaper-docs//" class="external-link">Source</a>
      /
      <a href="https://github.com/carpentries/sandpaper-docs//blob/main/CITATION" data-checker-ignore class="external-link">Cite</a>
      /
      <a href="mailto:zkamvar@carpentries.org">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Built with <a href="https://github.com/carpentries/sandpaper" class="external-link">sandpaper (0.0.0.9073)</a>,
      <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.0.0.9033)</a>,
      and <a href="https://github.com/carpentries/varnish" class="external-link">varnish (0.0.0.9008)</a>.
    </div>
  </div>
</div>
<!-- END:   inst/pkgdown/templates/footer.html-->

      </footer></div>

  <!-- START: inst/pkgdown/templates/docsearch.html -->

<!-- END:   inst/pkgdown/templates/docsearch.html-->


  </body></html><!-- END:   inst/pkgdown/templates/layout.html-->

